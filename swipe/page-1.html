<!doctype html>
<html lang="es">

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>PÃ¡gina 1</title>
        <link rel="stylesheet" href="./styles.css" />

        <!-- Setea direcciÃ³n antes de render (para que el slide sea correcto) -->
        <script>
            (function () {
                const dir = sessionStorage.getItem("vt_dir");
                if (dir) document.documentElement.dataset.vtDir = dir; // "next" | "prev"
                sessionStorage.removeItem("vt_dir");
            })();
        </script>
    </head>

    <body class="bg-1">
        <div class="card">
            <div>ğŸ“± PÃ¡gina 1 (naranja)</div>
            <div class="hint">Swipe izquierda â†’ siguiente | Swipe derecha â†’ anterior</div>

            <div class="row">
                <a class="btn" href="page-3.html" data-nav="prev">â† Ir a PÃ¡gina 3</a>
                <a class="btn" href="page-2.html" data-nav="next">Ir a PÃ¡gina 2 â†’</a>
            </div>
        </div>

        <script>
            (function () {
                const prevUrl = "page-3.html";
                const nextUrl = "page-2.html";

                // para ver animaciÃ³n tambiÃ©n con click en desktop
                document.querySelectorAll("a[data-nav]").forEach(a => {
                    a.addEventListener("click", () => {
                        sessionStorage.setItem("vt_dir", a.getAttribute("data-nav"));
                    });
                });

                // swipe solo en mobile
                const isMobile =
                    matchMedia("(pointer: coarse)").matches ||
                    /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

                if (!isMobile) return;

                let startX = 0, startY = 0, startT = 0, tracking = false;
                const minDistance = 70; // px
                const maxVertical = 60; // px
                const maxTime = 650;    // ms

                window.addEventListener("pointerdown", (e) => {
                    if (e.pointerType && e.pointerType !== "touch") return;
                    if (e.isPrimary === false) return;
                    tracking = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    startT = performance.now();
                }, { passive: true });

                window.addEventListener("pointerup", (e) => {
                    if (!tracking) return;
                    tracking = false;

                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;
                    const dt = performance.now() - startT;

                    if (dt > maxTime) return;
                    if (Math.abs(dy) > maxVertical) return;
                    if (Math.abs(dx) < minDistance) return;

                    if (dx < 0) { // izquierda => next
                        sessionStorage.setItem("vt_dir", "next");
                        location.assign(nextUrl);
                    } else {      // derecha => prev
                        sessionStorage.setItem("vt_dir", "prev");
                        location.assign(prevUrl);
                    }
                }, { passive: true });

                window.addEventListener("pointercancel", () => { tracking = false; }, { passive: true });
            })();
        </script>
    </body>

</html>
